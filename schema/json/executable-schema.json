{
  "$id": "https://bit.ly/ivoa-executable",
  "$schema": "https://json-schema.org/draft-07/schema",
  "definitions": {
    "UUIDType": {
      "type": "string",
      "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
    },
    "URIType": {
      "type": "string",
      "pattern": "^([0-9a-zA-Z]{1,}){1}:([0-9a-zA-Z]{1,}(.[-0-9a-zA-Z]){1,}){0,}(/([-./0-9a-zA-Z]){0,}){0,}$"
    },
    "ISO8601DurationType": {
      "type": "string",
      "pattern": "^P([0-9]+Y){0,1}([0-9]+M){0,1}([0-9]+D){0,1}(T([0-9]+H){0,1}([0-9]+M){0,1}([0-9]+S){0,1}){0,1}$"
      },
    "ISO8601DateType": {
      "type": "string",
      "pattern": "^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2}(\\.[0-9]{1,}){0,1}(([+-][0-9]{2}:[0-9]{2})|Z){0,1}$"
    },
    "SimpleNameType": {
      "type": "string",
      "pattern": "^[_a-zA-Z]{1}[-_ 0-9a-zA-Z]{0,}$"
    },
    "EnvVarNameType": {
      "type": "string",
      "pattern": "^[_a-zA-Z]{1}[-_0-9a-zA-Z]{0,}$"
    },
    "BasicComplexType": {
      "type": "object",
      "properties": {
        "uuid": {
          "$ref": "#/$defs/UUIDType"
        },
        "name": {
          "$ref": "#/$defs/SimpleNameType"
        },
        "type": {
          "$ref": "#/$defs/URIType"
        },
        "description": {
          "type": "string"
        }
      },
      "required": [
        "name",
        "type",
        "uuid"
      ]
    },
    "ComputeVolumeSpec": {
      "type": "object",
      "properties": {
        "type": "string",
        "path": "string",
        "access": "string"
      }
    },
    "LocalVolumeSpec": {
      "type": "object",
      "allOf": [
        {
          "$ref": "#/$defs/ComputeVolumeSpec"
        }
      ],
      "properties": {
        "minsize": "integer",
        "maxsize": "integer"
      }
    },
    "ResourceVolumeSpec": {
      "type": "object",
      "allOf": [
        {
          "$ref": "#/$defs/ComputeVolumeSpec"
        }
      ],
      "properties": {
        "resource": "string"
      }
    },
    "ComputeResourceType": {
      "type": "object",
      "allOf": [
        {
          "$ref": "#/$defs/BasicComplexType"
        }
      ],
      "properties": {
        "cardinality": "integer",
        "mincores": "integer",
        "maxcores": "integer",
        "minmemory": "integer",
        "maxmemory": "integer",
        "volumes": {
          "type": "array",
          "items": {
            "oneOf": [
              {
                "$ref": "#/$defs/LocalVolumeSpec"
              },
              {
                "$ref": "#/$defs/ResourceVolumeSpec"
              }
            ]
          }
        }
      }
    },
    "DataResourceType": {
      "type": "object",
      "allOf": [
        {
          "$ref": "#/$defs/BasicComplexType"
        }
      ],
      "properties": {}
    },
    "StorageResourceType": {
      "type": "object",
      "allOf": [
        {
          "$ref": "#/$defs/BasicComplexType"
        }
      ],
      "properties": {
        "minsize": "integer",
        "maxsize": "integer"
        }
    },
    "EphemeralStorageType": {
      "type": "object",
      "allOf": [
        {
          "$ref": "#/$defs/StorageResourceType"
        }
      ],
      "properties": {
        }
    },
    "PersistentStorageType": {
      "type": "object",
      "allOf": [
        {
          "$ref": "#/$defs/StorageResourceType"
        }
      ],
      "properties": {
        "minlifetime": {
          "$ref": "#/$defs/ISO8601DurationType"
          },
        "maxlifetime": {
          "$ref": "#/$defs/ISO8601DurationType"
          }
        }
    },
    "ExecutableTaskType": {
      "type": "object",
      "allOf": [
        {
          "$ref": "#/$defs/BasicComplexType"
        }
      ],
      "properties": {
        "minduration": {
          "$ref": "#/$defs/ISO8601DurationType"
          },
        "maxduration": {
          "$ref": "#/$defs/ISO8601DurationType"
          },
        "data-resources": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/DataResourceType"
          },
        "compute-resources": {
            "type": "array",
            "items": {
              "$ref": "#/$defs/ComputeResourceType"
            },
        "storage-resources": {
              "type": "array",
              "items": {
                "$ref": "#/$defs/StorageResourceType"
            }
          }
        }
      }
    },
    "ExecutableTaskList": {
      "type": "array",
      "items": {
        "$ref": "#/$defs/ExecutableTaskType"
        }
      }
    }
  }
}